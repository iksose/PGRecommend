"use strict";var app=angular.module("uiRouterSample",["angular-table"]).run(["$rootScope",function(){}]);angular.module("uiRouterSample").factory("recoFactory",function(e){var t=document.getElementsByClassName("dvCustId")[0].innerText;return{getPurchases:function(){return e.get("/_vti_bin/ProfitguardRecommendationsWCF.svc/GetPurchases/"+t)},getRecommendations:function(){return e.get("/_vti_bin/ProfitguardRecommendationsWCF.svc/GetRecommendations/"+t)}}}),angular.module("uiRouterSample").controller("filters",function(e){e.filters={},$traceurRuntime.setProperty(e.filters,"Primary Wholesaler",{enabled:!1,text:["Endorsed Wholesaler Contract to PBA","Endorsed Wholesaler Non-Contract to Endorsed Wholesaler Contract","Endorsed Wholesaler Contract to Endorsed Wholesaler Contract","Endorsed Wholesaler Non-Contract to PBA"]}),$traceurRuntime.setProperty(e.filters,"From PBA",{enabled:!1,text:["PBA to Endorsed Wholesaler Contract"]}),$traceurRuntime.setProperty(e.filters,"Source",{enabled:!1,text:["Endorsed Wholesaler Contract to PBA","Endorsed Wholesaler Contract to Endorsed Wholesaler Contract","PBA to Endorsed Wholesaler Contract"]}),$traceurRuntime.setProperty(e.filters,"Non Contract",{enabled:!1,text:["Endorsed Wholesaler Non-Contract to Endorsed Wholesaler Contract","Endorsed Wholesaler Non-Contract to PBA"]}),e.filterClick=function(t,r){var n=t,o=document.getElementById(r.target.id);1==e.filters[$traceurRuntime.toProperty(n)].enabled?(e.filters[$traceurRuntime.toProperty(n)].enabled=!1,o.className=r.target.id):(e.filters[$traceurRuntime.toProperty(n)].enabled=!0,o.className+=" "+r.target.id+"Red"),e.ammend()},e.ammend=function(){var t=[],r=!1;for(var n in e.filters)if(e.filters[$traceurRuntime.toProperty(n)].enabled){r=!0,console.log("Filter for",n,"is true, do this");var o=!0,a=t.length>0?t:[],s=t.length>0?t:e.$parent.myPurchases_copy;console.log("Value of jesus on second pass",a.length);for(var l=0;l<e.filters[$traceurRuntime.toProperty(n)].text.length;l++){if(!o){console.log("On second run...",l);var i=_.reject(a,function(t){return t.RecoType==e.filters[$traceurRuntime.toProperty(n)].text[$traceurRuntime.toProperty(l)]});a=i}if(o){console.log("On first run...",l),console.log(s.length);var i=_.reject(s,function(t){return t.RecoType==e.filters[$traceurRuntime.toProperty(n)].text[$traceurRuntime.toProperty(l)]});a=i;var o=!1}}var t=a;console.log("Done with first filter for",n,t),e.$parent.myPurchases=a}r||(console.log("No filters..."),e.$parent.myPurchases=e.$parent.myPurchases_copy),e.$parent.destroy(),setTimeout(function(){e.$parent.ammendment()},100)}}),angular.module("uiRouterSample").controller("TodoCtrl",function(e,t){function r(){var t;try{t=JSON.parse(localStorage[$traceurRuntime.toProperty("PBA Profitguard")])}catch(r){return}for(var n=e.myPurchases,o=Date.parse(new Date),a=0;a<t.length;a++){if(Date.parse(t[$traceurRuntime.toProperty(a)].storeDate)>o){var s=_.reject(n,function(e){return e.RowID==t[$traceurRuntime.toProperty(a)].rowID});n=s}else t.pop(a),a--;$traceurRuntime.setProperty(localStorage,"PBA Profitguard",JSON.stringify(t)),e.myPurchases=n}}e.myPurchases={},e.myPurchases_copy={},t.getPurchases().then(function(t){var n=[];t.data.aaData.forEach(function(e){e.TotalSavings=parseFloat(parseFloat(e.TotalSavings).toFixed(2)),e.RecoType_small="PBA to Endorsed Wholesaler Contract"==e.RecoType?"PBA Health":"Primary Wholesaler",e.SalesPrice=parseFloat(e.SalesPrice).toFixed(2),e.Total=parseFloat(e.Total).toFixed(2),n.push(e)}),e.myPurchases=n,e.myPurchases_copy=n,r(),e.pagination[3].shade=n.length}),e.myRecommendations={},t.getRecommendations().then(function(t){var r=[];t.data.aaData.forEach(function(e){e.RecoType="Endorsed Wholesaler Contract to PBA"==e.RecoType?"PBA Health":"Primary Wholesaler",r.push(e)}),e.myRecommendations=r,e.ammendment()}),e.selectChanged=function(t){console.log("select changed",e.tableConfig.itemsPerPage," old ",t.shade," new"),e.tableConfig.oldAmount=e.tableConfig.itemsPerPage,e.tableConfig.itemsPerPage=t.shade,e.destroy(),setTimeout(function(){e.ammendment()},100)},e.pagination=[{name:5,shade:5},{name:10,shade:10},{name:20,shade:20},{name:"All",shade:3}],e.myPagination=e.pagination[0],e.tableConfig={itemsPerPage:e.myPagination.shade,fillLastPage:!1,maxPages:10,oldAmount:e.myPagination.shade},e.tableConfig.currentPage=1,e.$watch("tableConfig.currentPage",function(t,r){t!==r&&(e.destroy(e.tableConfig.itemsPerPage),setTimeout(function(){e.ammendment()},100))}),e.ammendment=function(){for(var t=e.tableConfig.itemsPerPage,r=document.getElementById("queryTable"),n=document.getElementsByClassName("mainRows"),o=0;t>o;o++){var a=r.insertRow(n[$traceurRuntime.toProperty(o)].rowIndex+1);a.id="row"+o,a.insertCell(0).innerHTML='<input type="radio" class="hideSuggest" data-rowid='+n[$traceurRuntime.toProperty(o)].id+"> <small>Hide</small>",a.insertCell(1).innerHTML="Recommendation",a.cells[1].className="Bubba";var s=_.findWhere(e.myRecommendations,{RowID:n[$traceurRuntime.toProperty(o)].id});a.insertCell(2).innerHTML=s.NDC,a.insertCell(3).innerHTML=s.Descr,a.insertCell(4).innerHTML=s.MfgName,a.insertCell(5).innerHTML=s.Form,a.insertCell(6).innerHTML=s.Str,a.insertCell(7).innerHTML=s.Size,a.insertCell(8).innerHTML="",a.insertCell(9).innerHTML="$"+parseFloat(s.RecSalesPrice).toFixed(2),a.insertCell(10).innerHTML="$"+parseFloat(s.RecTotal).toFixed(2);var l=_.findWhere(e.myPurchases,{RowID:n[$traceurRuntime.toProperty(o)].id});1==l.checked&&(document.getElementById("checkbox"+n[$traceurRuntime.toProperty(o)].id).checked=!0),a.insertCell(11).innerHTML=l.TotalSavings,a.cells[11].className="bold",a.insertCell(12).innerHTML=s.RecoType,a.cells[12].className="bold",a.insertCell(13).innerHTML="$"+parseFloat(l.TotalSavings).toFixed(2),a.cells[13].className="bold"}e.applyEvents()};e.applyEvents=function(){for(var e=document.getElementsByClassName("hideSuggest"),t=0;t<e.length;t++)angular.element(e[$traceurRuntime.toProperty(t)]).on("click",function(e){return e.preventDefault(),!1})},e.destroy=function(){for(var e=document.getElementById("queryTable"),t=document.getElementsByClassName("mainRows"),r=1;r<=t.length;r++)e.rows[$traceurRuntime.toProperty(r+1)].remove()},e.selected=0}),angular.module("uiRouterSample").controller("printCtrl2",function(e,t,r){e.addPrint=function(t,r){if("checkbox"==r.target.type){var n=_.findWhere(e.myPurchases,{RowID:t});return n.checked=document.getElementById("checkbox"+t).checked,void(n.checked?e.selected++:e.selected--)}if(document.getElementById("checkbox"+t).checked){document.getElementById("checkbox"+t).checked=!1;var n=_.findWhere(e.myPurchases,{RowID:t});n.checked=!1,e.selected--}else{document.getElementById("checkbox"+t).checked=!0;var n=_.findWhere(e.myPurchases,{RowID:t});n.checked=!0,e.selected++}},e.printAll=function(){var t=r;t.sessionStorage.purchases=angular.toJson(e.myPurchases),t.sessionStorage.recommendations=angular.toJson(e.myRecommendations),t.sessionStorage.printText="Showing All",t.open("/views/printAll.html")},e.selected=0,e.printSelected=function(){var t=r,n=_.where(e.myPurchases,{checked:!0});t.sessionStorage.purchases=angular.toJson(n),t.sessionStorage.recommendations=angular.toJson(e.myRecommendations),t.sessionStorage.printText="Showing "+n.length+" of "+e.pagination[3].shade,t.open("/views/printAll.html")}}),angular.module("uiRouterSample").controller("print_page_Ctrl",function(e){function t(){for(var t=e.tableConfig.itemsPerPage,r=document.getElementById("queryTable"),n=document.getElementsByClassName("mainRows"),o=0;t>o;o++){var a=r.insertRow(n[$traceurRuntime.toProperty(o)].rowIndex+1);a.id="row"+o,a.insertCell(0).innerHTML='<input type="radio" class="hideSuggest" data-rowid='+n[$traceurRuntime.toProperty(o)].id+"> <small>Hide</small>",a.insertCell(1).innerHTML="Recommendation",a.cells[1].className="Bubba";var s=_.findWhere(e.myRecommendations,{RowID:n[$traceurRuntime.toProperty(o)].id});a.insertCell(2).innerHTML=s.NDC,a.insertCell(3).innerHTML=s.Descr,a.insertCell(4).innerHTML=s.MfgName,a.insertCell(5).innerHTML=s.Form,a.insertCell(6).innerHTML=s.Str,a.insertCell(7).innerHTML=s.Size,a.insertCell(8).innerHTML="",a.insertCell(9).innerHTML="$"+parseFloat(s.RecSalesPrice).toFixed(2),a.insertCell(10).innerHTML="$"+parseFloat(s.RecTotal).toFixed(2);var l=_.findWhere(e.myPurchases,{RowID:n[$traceurRuntime.toProperty(o)].id});a.insertCell(11).innerHTML=l.TotalSavings,a.cells[11].className="bold",a.insertCell(12).innerHTML=s.RecoType,a.cells[12].className="bold",a.insertCell(13).innerHTML="$"+l.TotalSavings,a.cells[13].className="bold"}}console.log("Welcome to the print Controller"),e.printText=sessionStorage.printText,e.myPurchases=JSON.parse(sessionStorage.purchases),e.myRecommendations=JSON.parse(sessionStorage.recommendations),setTimeout(function(){t()},100),setTimeout(function(){window.print()},500),e.colors=[{name:5,shade:5},{name:10,shade:10},{name:20,shade:20},{name:"All",shade:1e3}],e.myColor=e.colors[0],e.tableConfig={itemsPerPage:1e3,fillLastPage:!1,oldAmount:e.myColor.name}});